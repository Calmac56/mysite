{% extends 'mysiteapp/base.html' %}
{% load static %}

{% block body_block %}
<script>
    var data = jQuery.getJSON('https://api.github.com/users/Calmac56/repos');
    $(document).ready(function() {
			
               $.getJSON('https://api.github.com/users/Calmac56/repos', function(jd) {
                   console.log(jd[0].name);
                   var length = jd.length;
                   var names = [];
                   var creationdates = [];
                   var modifieds = [];
                   var languages = [];
                   var link = 'https://api.github.com/repos/Calmac56/';
                   var endlink = '/languages'

                   for(var i= 0; i < length; i++){
                       names.push(jd[i].name);
                       creationdates.push(jd[i].created_at)
                       modifieds.push(jd[i].updated_at)
                       console.log(jd[i].created_at)
                       var langlink = link + jd[i].name + endlink
                       $.getJSON(langlink, function(s){
                        languages.push(s);
                        console.log(s);
                   });
                   }
                   $.ajax({
                        url: "{% url 'mysiteapp:getprojects'%}",
                        type:"GET",
                        dataType:"json",
                        data: {'name':names,'creation':creationdates, 'modified':modifieds,'language':languages }
                    }).done(function(data){
                         alert("Projects downloaded");//do what you want to do with response
                 });
            });
        });
</script>
{% endblock %}